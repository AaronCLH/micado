<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Micado Documentation</title>
<link rel="stylesheet" type="text/css" href="doc/micado.css" /> 
</head>

<body>

<ul id="minitabs">
    <li>(<a href="index.html">index</a>)</li>
    <li>(<a href="download.html">download</a>)</li>
    <li>(<a href="screencasts.html">screencasts</a>)</li>
    <li>(<a id="current" href="documentation.html">documentation</a>)</li>
	<li>(<a href="about.html">about</a>)</li>
</ul>

<h1>Micado Documentation</h1>

<p>Contents:</p>
<!-- start toc.  do not edit; run html-update-toc instead -->
    <ul>
      <li><a href="#drawing">Drawing</a>
        <ul>
          <li><a href="#drawing-flow">Flow</a></li>
          <li><a href="#drawing-control">Control</a></li>
          <li><a href="#drawing-commands">Drawing Commands</a>
            <ul>
              <li><a href="#PlacePunch"><img src="doc/images/tool-punch.png"></img><code>PlacePunch</code></a></li>
              <li><a href="#PlaceValve"><img src="doc/images/tool-valve.png"></img><code>PlaceValve</code></a></li>
            </ul></li>
          <li><a href="#SettingsDrawing"><img src="doc/images/tool-settings.png"></img>Drawing Settings</a></li>
        </ul></li>
      <li><a href="#layers">Layers</a>
        <ul>
          <li><a href="#SettingsLayers"><img src="doc/images/tool-settings.png"></img>Layers Settings</a></li>
        </ul></li>
      <li><a href="#routing"><img src="doc/images/tool-connect.png"></img>Routing</a>
        <ul>
          <li><a href="#SettingsRouting"><img src="doc/images/tool-settings.png"></img>Routing Settings</a></li>
        </ul></li>
      <li><a href="#Settings"><img src="doc/images/tool-settings.png"></img>Settings</a>
        <ul>
          <li><a href="#units"><em>A Note About Units</em></a></li>
          <li><a href="#SettingsImportExport">Import.../Export...</a></li>
        </ul></li>
      <li><a href="#Generation">Generation of Instructions</a>
        <ul>
          <li><a href="#GenerationCommands">Commands</a></li>
          <li><a href="#JavaGUI">Java GUI</a></li>
        </ul></li>
    </ul>
<!-- end toc -->

<h2><a name="drawing"></a>Drawing</h2>
<h3><a name="drawing-flow"></a>Flow</h3>
<p><ul>
 <li><em>Flow lines</em> should be drawn as polyline rectangles.</li>
 <li><em>Flow punches</em> should be drawn using the <a href="#PlacePunch"><code>PlacePunch</code></a> command.</li>
</ul></p>

<h3><a name="drawing-control"></a>Control</h3>
<p><ul>
 <li><em>Valves</em> should be drawn using the <a href="#PlaceValve"><code>PlaceValve</code></a> command. Valves may be connected together by polylines (preferrably polyline rectangles), in order to be part of the same control line.</li>
 <li><em>Control punches</em> should be drawn using the <a href="#PlacePunch"><code>PlacePunch</code></a> command.</li>
 <li><em>Obstacles</em>, which are regions to be avoided during routing, should be drawn as polylines. As opposed to control lines, obstacles should not intersect a valve or a polyline that intersect a valve.</li>
</ul></p>

<h3><a name="drawing-commands"></a>Drawing Commands</h3>
<h4><a name="PlacePunch"></a><img src="doc/images/tool-punch.png"></img><code>PlacePunch</code></h4>
<p>
The <code>PlacePunch</code> command is accessed by the Micado toolbar button <img src="doc/images/tool-punch.png"></img>. It prompts the user for a point and draws a punch with the given point as center. The <a href="#SettingsDrawing">Drawing Settings</a> defines how the punch will be drawn.
</p>

<h4><a name="PlaceValve"></a><img src="doc/images/tool-valve.png"></img><code>PlaceValve</code></h4>
<p>
The <code>PlaceValve</code> command is accessed by the Micado toolbar button <img src="doc/images/tool-valve.png"></img>. It prompts the user to select a point on a flow segment and draws a valve centered on the flow segment near the chosen point. The width and height of the valve are proportional to the width of the flow segment, the exact ratios being defined in the <a href="#SettingsDrawing">Drawing Settings</a>.
</p>

<h3><a name="SettingsDrawing"></a><img src="doc/images/tool-settings.png"></img>Drawing Settings</h3>
<p>
The Drawing Settings are in the Drawing tab of the <a href="#Settings">Micado Settings</a>.
</p>
<div class="screenshot"><img src="doc/images/settings-drawing.png"></img>
<br></br>
Drawing tab (<a href="#units">*</a>)
</div>

<h2><a name="layers"></a>Layers</h2>
<p>Micado must be told which AutoCAD layers are flow layers and which are control layers. Notably, this is important for <a href="#routing">routing</a>.
</p>
<h3><a name="SettingsLayers"></a><img src="doc/images/tool-settings.png"></img>Layers Settings</h3>
<p>
The Layers Settings are in the Layer tab of the <a href="#Settings">Micado Settings</a>.
A layer is identified by its name. You can add a layer as a Flow layer or Control layer by adding its named, checked, to the corresponding checked box list. To delete a layer from the list of Flow layers or Control Layers, simply uncheck its name in the corresponding checked box list.
Note that it's not permitted to have a layer be both a flow and a control layer.
</p>
<div class="screenshot"><img src="doc/images/settings-layers.png"></img>
<br></br>
Layers tab
</div>

<h2><a name="routing"></a><img src="doc/images/tool-connect.png"></img>Routing</h2>
<p>Micado automatically routes valves to punches with the <code>ConnectValvesToPunches</code> command, accessible by the Micado toolbar button <img src="doc/images/tool-connect.png"></img>.</p>

<p>Micado collects entities in the flow and control <a href="#layers">layers</a>. It groups the control entities into control lines: a control line consists of at least one valve, together with all other entities (valves, punches or polylines) that are connected, directory or indirectly, to that valve. If a control line already has a punch, then it is considered already connected, and will be left alone. The routing command simply attempts to connect each unconnected control line to an unconnected control punch (so the number of unconnected control punches must be at least equal to the number of unconnected control lines). This way, the routing command can be invoked iteratively to connect an already partially connected chip.
</p>

<p>Micado constraints the connections to be legal by the design rules, which are specified in the <a href="#SettingsRouting">Routing Settings</a>.
In particular,
<ul>
 <li>A connection line will not follow or cross a flowline in a parallel direction.</li>
 <li>A connection line respects a minimum distance to any other connection line.</li>
 <li>A connection line respects a minimum distance to any punch center, apart from the punch it is connecting to.</li>
 <li>A connection line doesn't cross any other control line.</li>
 <li>A connection line doesn't cross any obstacle.</li>
</ul>
</p>

<h3><a name="SettingsRouting"></a><img src="doc/images/tool-settings.png"></img>Routing Settings</h3>
<p>
The Routing Settings are in the Routing tab of the <a href="#Settings">Micado Settings</a>.
Perhaps, the most important setting is the <em>Minimum Distance from a Line to another Line</em>, as it specifies the resolution of the manhattan grid used for routing. The <em>Extra Space</em> settings are to extend the constraints around the entity boundaries. For example, if <em>extra space around a Flowline</em> is specified, then the constraint of not following or crossing a flowline in a parallel direction is extended to include the extra space around a flowline. Similarly, the <em>extra space around a Valve</em> forbids a connection line from passing too close to another valve.
</p>
<div class="screenshot"><img src="doc/images/settings-routing.png"></img>
<br></br>
Routing tab (<a href="#units">*</a>)
</div>
<p>

</p>

<h2><a name="Settings"></a><img src="doc/images/tool-settings.png"></img>Settings</h2>
<p>All the Micado Settings are accessible with the command <code>MicadoSettings</code> or the Micado toolbar button <img src="doc/images/tool-settings.png"></img>.</p>

<p>Each tab in the Micado Settings is discussed in details elsewhere:
<ul>
 <li><a href="#SettingsDrawing">Drawing</a>,</li>
 <li><a href="#SettingsLayers">Layers</a>,</li>
 <li><a href="#SettingsRouting">Routing</a>.</li>
</ul>
</p>

<h3><a name="units"></a><em>A Note About Units</em></h3> 
<p>For the settings which have units, Micado uses the Insertion Scale of the AutoCAD drawing. To change the Insertion Scale in AutoCAD, select the menu Format, then Units... (The example figures are given in milimeters.)
</p>

<h3><a name="SettingsImportExport"></a>Import.../Export...</h3>
<p>
For your convenience, the settings are persisted from one AutoCAD session to another by being stored in a micado-specific Application Data folder.
In addition, you can explicitly export and import Micado settings, in order to share them with your drawings.
</p>

<h2><a name="Generation"></a>Generation of Instructions</h2>
<p>Micado automatically generates a programmable Java GUI for your chip.
You simply specify the set of instructions to export to the GUI by annotating the flow.
</p>

<p>The flow annotations can either be simple, representing an input/output flow punch or a flow path, or composed, hierarchically representing flow in sequence or in parallel. In parallel, <code>AND</code> specifies that each flow should be taken <em>at once</em>, and <code>OR</code> specifies that each flow should be taken <em>separately</em>. Composing flow in parallel with <code>OR</code> leads to a combinatorial explosion of instructions, because an instruction is generated for each possible combination of flow.</p>

<p>Once the flow is annotated with names, you create an instruction set by specifying a named flow and an entity on the drawing. The drawing entity becomes the button or set of buttons to run the instruction set.
</p>

<h3><a name="GenerationCommands"></a>Commands</h3>

<ul>
 <li><a name="InputCommands"></a>Inputs
  <ul>
   <li><a name="NewBoxInput"></a><img src="doc/images/icons/NewBoxInput.png"></img> Name an input<br><i>Creates a new named flow from an input punch.</i></li>
   <li><a name="NewBoxOrInput"></a><img src="doc/images/icons/NewBoxOrInput.png"></img> Compose in parallel (OR)<br><i>Creates a new named flow as an exclusive combination of input punches, without having to name all the punches individually.</i></li>
  </ul>
 <li><a name="InputCommands"></a>Outputs
  <ul>
   <li><a name="NewBoxOutput"></a><img src="doc/images/icons/NewBoxOutput.png"></img> Name an output<br><i>Creates a new named flow from an output punch.</i></li>
   <li><a name="NewBoxOrOutput"></a><img src="doc/images/icons/NewBoxOrOutput.png"></img> Compose in parallel (OR)<br><i>Creates a new named flow as an exclusive combination of output punches, without having to name all the punches individually.</i></li>
  </ul>
 <li><a name="InputCommands"></a>Flows
  <ul>
   <li><a name="NewBoxPath"></a><img src="doc/images/icons/NewBoxPath.png"></img> Name a flow<br><i>Creates a new named flow as a simple directed path from one point to another. Micado automatically infers the simplest path between the two clicked points.</i></li>
   <li><a name="NewBoxOr"></a><img src="doc/images/icons/NewBoxOr.png"></img> Compose in parallel (OR)<br><i>Creates a new named flow as some exclusive combination of other named flows. The user also specifies whether to order the possibilities horizontally and vertically for the buttons, and the point(s) where the parallel flows meet.</i></li>
   <li><a name="NewBoxAnd"></a><img src="doc/images/icons/NewBoxAnd.png"></img> Compose in parallel (AND)<br><i>Creates a new named flow by grouping parallel named flows and clicking on the point(s) where all the parallel flows meet.</i></li>
   <li><a name="NewBoxSeq"></a><img src="doc/images/icons/NewBoxSeq.png"></img> Compose in sequence<br><i>Creates a new named flow by composing other named flows in sequence. Micado will automatically complete the flow path between successive named flows in the sequence.</i></li>
   <li><a name="MarkBox"></a><img src="doc/images/icons/MarkBox.png"></img> Highlight a flow<br><i>Draws a named flow.</i></li>   
  </ul>   
 </li>
 <li><a name="InputCommands"></a>Instructions
  <ul>
   <li><a name="NewInstructionSet"></a><img src="doc/images/icons/NewInstructionSet.png"></img> Define from flow<br><i>Defines an instruction set by selecting a named flow and an entity to be used for the buttons.</i></li>
   <li><a name="MarkInstruction"></a><img src="doc/images/icons/MarkInstruction.png"></img> Highlight one<br><i>Draws an instruction, selected by clicking on its entity button.</i></li>   
   <li><a name="ListInstructions"></a><img src="doc/images/icons/ListInstructions.png"></img> Highlight all<br><i>Draws all instructions and crosses over the entities used as buttons.</i></li>   
  </ul>   
 </li>
 <li><a name="ClearMarks"></a>Clear highlighting<br><i>Clears the temporary drawings made to highlight flows and instructions.</i></li>
 <li><a name="FileCommand">File
 <ul>
    <li><a name="ImportBoxesAndInstructions"></a><img src="doc/images/icons/ImportBoxesAndInstructions.png"></img> Open<br><i>Open an XML file, saved previously, containing named flows and instructions.</i></li>
   <li><a name="ExportBoxesAndInstructions"></a><img src="doc/images/icons/ExportBoxesAndInstructions.png"></img> Save<br><i>Save the named flows and instructions to an XML file.</i></li>
   <li><a name="ExportToGUI"></a><img src="doc/images/icons/ExportToGui.png"></img> Export to Java GUI<br><i>Creates a Java GUI with the drawing and instructions. The exported files should be saved, as <code>AppName.png</code> and <code>AppName.dat</code> in <code>javagui/src/</code>, so that the Java application can be built by simply calling <code>build.bat AppName</code> in that directory.</i></li>   
   <li><a name="NumberControlLines"></a><img src="doc/images/icons/NumberControlLines.png"></img> Number Control Lines<br><i>Specify the numbering of the control lines to be used in the Java GUI. The custom numbering is to make it easy to map the logical ports to the physical ports on the chip.</i></li>  
 </ul></li>
</ul>
 
 <h3><a name="JavaGUI"></a>Java GUI</h3>
 <p>For each instruction, the Java program contains a method to call the instruction from your code.
 In addition, each instruction set leads to a parameterized method, the arguments being the indices specifying the choices made along the parallel flow paths composed with <code>OR</code>.
 </p>
 
</body>

</html>
